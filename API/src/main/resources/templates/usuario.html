<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Pancora</title>
        <link rel="stylesheet" href="/css/cadastro_style.css">
        <link rel="stylesheet" href="/css/fixed_footer.css">
    </head>

    <header>
        <nav class="navbar">
            <a href="/" class="nav-logo">Pancora</a>
            <ul class="nav-menu">
                <li class="nav-item">
                    <a href="/cadastro-paciente" class="nav-link">Cadastro de paciente</a>
                </li>
                <li class="nav-item">
                    <a href="/cadastro-empresa" class="nav-link">Cadastro de empresa</a>
                </li>
                <li class="nav-item">
                    <a href="/cadastro-sintoma" class="nav-link">Cadastro de sintoma</a>
                </li>
                <li class="nav-item">
                    <a href="/lista-paciente" class="nav-link">Quadro de Pacientes</a>
                </li>
                <li class="nav-item">
                    <a href="/usuario" class="nav-link">Usuários</a>
                </li>
                <li class="nav-item">
                    <a href="/registration" class="nav-link">Cadastro de Usuário</a>
                </li>
                <li class="nav-item">
                    <a href="/logout" class="nav-link">Sair</a>
                </li>
            </ul>
            <div class="hamburger">
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
            </div>
        </nav>
    </header>

    <body>
    <div class="container">
        <h1>Usuários cadastrados</h1>

        <div id="div-busca" style="text-align: center!important;">
            <button id="btn-busca" onclick="buscarUsuarios();" style="padding: 8px;background-color: #4dccc6;color: white; border-radius: 4px;border: 1px solid #4dccc6;">Buscar usuários</button>
        </div>
        <table class="table">
            <thead>
            <tr>
                <th class="space-list">Username</th>
                <th class="space-list">Email</th>
            </tr>
            </thead>
            <tbody id="registros">

            </tbody>
        </table>
    </div>

    <canvas class="background"></canvas>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/particlesjs/2.2.2/particles.min.js"></script>
    <script src="/js/particlesBackground.js"></script>
    <script>
        function buscarUsuarios(){
            var url = "http://localhost:8000/listar-usuario";

            var xhttp = new XMLHttpRequest();
            xhttp.open("GET", url, false);

            xhttp.send();//A execução do script pára aqui até a requisição retornar do servidor

            var dados = xhttp.responseText;
            var html = "";
            JSON.parse(dados).forEach( function (registro){
                html += '<tr><td class="space-list">'
                +registro.username
                +'</td><td class="space-list">'
                +registro.email
                +"</td></tr>"

<!--[{"id":1,"username":"ana.epping01@gmail.com","email":"ana.epping01@gmail.com","password":"$2a$10$4qKQCZjPcnl6aDfx096GVuVB69Xh5omLS6JySOJAEwug9dq1pSLzG","appUserRole":"USER","locked":false,"enabled":true,"authorities":[{"authority":"USER"}],"accountNonExpired":true,"accountNonLocked":true,"credentialsNonExpired":true}]           })-->
           document.getElementById('registros').innerHTML = html;
        })
    }
    </script>
    </body>

    <footer className="footer mt-auto py-3 bg-dark">
        <div className="footer container">
            <p className="text-light">App desenvolvido por <a class="link-github" href="https://github.com/Ana-Epping" target="_blank" rel="noreferrer">Ana Luiza Epping</a>,
                <a class="link-github" href="https://github.com/BrunaZimmermannTregnago" target="_blank" rel="noreferrer">Bruna Zimmermann Tregnago</a>,
                <a class="link-github" href="https://github.com/evelynperondi" target="_blank" rel="noreferrer">Évelyn Perondi Filimberti</a> e
                <a class="link-github" href="https://github.com/isadoragbocalon" target="_blank" rel="noreferrer">Isadora Gambatto Bocalon</a></p>
            <p className="text-light"><a class="link-unoesc" href="https://www.unoesc.edu.br/" target="_blank" rel="noreferrer"><strong>Ciência da Computação - UNOESC SMO</strong></a><br/>
        </div>
    </footer>
</html>